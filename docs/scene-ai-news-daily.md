# 场景一：让 OpenClaw 每天自动生成 AI 领域新闻日报

> **快速概览 (Quick Summary)**
>
> | 属性 | 说明 |
> | :--- | :--- |
> | **预计耗时** | 5-10 分钟 |
> | **难度** | ⭐⭐ (需配置 MCP) |
> | **核心能力** | `web_search` + `aliyun_web_parser` + `dingtalk-cron-job` |
> | **目标** | 每天 09:00 自动推送到钉钉 |

## 一句话价值
每天固定时间自动抓取、筛选、摘要并推送一份结构化 AI 新闻日报到钉钉会话（私聊或群聊），帮助团队保持技术敏锐度。

---

## 1. 前置条件 (Prerequisites)

在开始之前，请确保你的 OpenClaw 已经准备好。你可以直接复制以下指令发送给 Bot 进行“交互式检查”：

```text
请帮我检查环境是否满足“AI 新闻日报”的运行要求：
1. 检查钉钉渠道是否已启用；
2. 检查 MCP 工具 web_search (config.aliyunMcp.tools.webSearch.enabled) 是否为 true；
3. 检查 MCP 工具 web_parser (config.aliyunMcp.tools.webParser.enabled) 是否为 true；
4. 检查是否有可用的 API Key (DASHSCOPE_API_KEY 或 aliyunMcp.apiKey)。

如果不满足，请告诉我具体的配置修改方法。
```

> 💡 **提示**：如果工具不可用，OpenClaw 会尝试走降级路径（仅根据 RSS 标题生成），但内容质量会下降。

---

## 2. 默认 AI 信息源 (Data Sources)

本方案默认配置以下高质量数据源，涵盖学术、产业、技术博客与热点：

| 来源名称 | 网址 | 类型 | 推荐指数 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| **ArXiv AI** | [arxiv.org](https://arxiv.org/) | 学术论文 | ⭐⭐⭐⭐⭐ | CS.AI 分类 |
| **OpenAI Blog** | [openai.com](https://openai.com/blog/) | 官方动态 | ⭐⭐⭐⭐⭐ | 重大发布首选 |
| **BestBlogs** | [bestblogs.dev](https://www.bestblogs.dev/) | 聚合精选 | ⭐⭐⭐⭐ | 需自动探测 RSS |
| **Hacker News** | [news.ycombinator.com](https://news.ycombinator.com/) | 极客热点 | ⭐⭐⭐⭐ | 筛选 AI 相关 |
| **GitHub Trending** | [github.com](https://github.com/trending) | 开源项目 | ⭐⭐⭐ | 每日趋势 |

---

## 3. 部署步骤 (Step-by-Step Guide)

### 步骤一：初始化智能体技能 (Initialize Skill)

我们需要创建一个名为 `ai-news-daily` 的 Skill，它包含了抓取、筛选、排版的核心逻辑。

请复制以下 **完整 Prompt** 发送给 OpenClaw。
*(注：Prompt 较长是为了包含防幻觉约束和严格的输出格式，请直接完整复制)*

```text
请帮我创建一个可复用 skill，名称为 ai-news-daily。
skill 文件路径使用 OpenClaw 工作区标准路径：
<workspace>/skills/ai-news-daily/SKILL.md
如果你无法确定 <workspace>，就使用 ~/.openclaw/workspace/skills/ai-news-daily/SKILL.md。

skill 目标：生成 AI 领域新闻日报。
skill 内必须定义固定流程：
1) 先验证并维护“日报源列表（v1）”，默认使用以下来源：
- https://rss.arxiv.org/rss/cs.AI
- https://openai.com/blog/rss.xml
- https://www.bestblogs.dev/（自动探测 RSS）
- https://hnrss.org/frontpage
- https://rsshub.app/github/trending/daily
2) 拉取候选内容（优先使用 web_search + aliyun_web_parser）；
3) 去重与质量评分；
4) 选出最重要的 5 条；
5) 按固定 Markdown 模板输出日报；
6) 工具不可用时执行降级，并明确标注不确定性。

另外请在创建 skill 后，立刻完成一次“初始化检查”：
- 输出日报源列表（v1），字段为：来源名、RSS 地址、可用状态、备注；
- 若某个源不可用，请给出替代 RSS 并说明原因。

请把以下“输出约束”写进 skill 的正文，作为硬性规则：
1) 仅允许使用“日报源列表（v1）”及其明确声明的替代源；不得临时引入未声明的新来源。
2) 最终日报默认输出 5 条；不足 5 条时，必须写“今日有效条目不足：X/5”，并解释缺失原因。
3) 每条新闻必须包含 5 个字段：
- 标题
- 三行内摘要
- 来源链接（可访问 URL）
- 发布时间（北京时间；若源中无时间则写“未知”，并标注不确定）
- 为什么重要（一句话）
4) 末尾必须包含两个区块：
- 今日观察（1-2 条）
- 可进一步跟进（1-2 条）
5) 末尾必须包含“数据源状态”，逐条列出 5 个默认源的状态，不可只给汇总数字。
6) 输出前必须做一次自检；若缺任一字段，先自我修正再输出。

请直接创建文件并返回：skill 路径、skill 摘要、初始化检查结果。不要只讲思路。
```

### 步骤二：验证与试运行 (Verify & Dry Run)

创建完成后，我们需要手动执行一次，确保 Skill 能正常工作且输出格式符合预期。

```text
请刷新 skills，然后立即手动执行一次 ai-news-daily。
执行要求：
1) 严格只使用“日报源列表（v1）”及其替代源，不得引入新来源；
2) 输出 5 条最重要新闻；如果不足 5 条，明确写“今日有效条目不足：X/5”并说明原因；
3) 每条包含：标题、三行内摘要、来源链接、发布时间（北京时间）、为什么重要；
4) 最后包含：今日观察（1-2 条）+ 可进一步跟进（1-2 条）；
5) 最后追加“数据源状态”，逐条列出 5 个默认源状态与备注；
6) 不要编造内容；不确定信息标注“不确定”。
输出前请先做“格式自检”，不合格就重写，直到完全满足要求再发送。
执行完成后请给我结果摘要，并明确这次是否满足“5 条新闻 + 固定格式 + 来源链接 + 发布时间 + 为什么重要 + 数据源状态逐条”。
```

### 步骤三：创建定时任务 (Schedule Cron Job)

验证通过后，我们将它设置为每天早上 09:00 自动发送。

```text
请调用 dingtalk-cron-job skill 创建每日任务：
- 任务名：AI 新闻日报
- 时间：每天 09:00（Asia/Shanghai）
- 目标：当前钉钉会话
- 执行指令：调用 ai-news-daily skill 生成日报并发送。
日报输出必须继续遵守这些硬性要求：
1) 仅使用“日报源列表（v1）”及其替代源；
2) 默认 5 条，不足 5 条写“今日有效条目不足：X/5”；
3) 每条包含：标题、三行内摘要、来源链接、发布时间（北京时间）、为什么重要；
4) 末尾必须有：今日观察、可进一步跟进、数据源状态（5个默认源逐条状态）；
5) 输出前先做自检，不合格不发送。
请直接完成创建，不要只返回命令教程。
```

### 步骤四：最终验收 (Final Acceptance)

最后，强制触发一次定时任务，确保调度器工作正常。

```text
请立即对“AI 新闻日报”定时任务做首次验收：
1) 强制执行一次任务并等待最终结果；
2) 查看最近运行记录；
最终告诉我：
1) 本次执行是否成功；
2) 如果失败，根因是什么；
3) 下次计划执行时间是什么时候；
4) 本次产出是否符合“5 条新闻 + 固定格式 + 来源链接 + 发布时间 + 为什么重要 + 数据源状态逐条”；
5) 若不符合，请给出你将如何修正 ai-news-daily skill 的具体修改项（逐条列出）。
```

---

## 4. 常见问题与故障排除 (FAQ & Troubleshooting)

### Q1: 日报生成的链接打不开怎么办？
*   **原因**：可能是源网站有防爬虫机制，或者 OpenClaw 在提取链接时截断了。
*   **解法**：检查 `web_search` 工具是否正常工作。如果频繁出现，可以要求 Skill "在生成链接时，优先使用原始 RSS 链接"。

### Q2: 为什么有时候新闻不足 5 条？
*   **原因**：当天 RSS 源更新较少，或者 `aliyun_web_parser` 过滤掉了质量较低的内容。
*   **解法**：这是正常现象（Feature not Bug）。如果不希望看到“有效条目不足”的提示，可以修改 Skill 逻辑，允许抓取最近 48 小时的新闻。

### Q3: 任务执行失败，如何降级？
如果 `web_search` 或 `aliyun_web_parser` 彻底不可用，Skill 会自动尝试仅通过 RSS 标题生成摘要。此时日报中会出现“覆盖面降低”或“建议开启网页解析”的提示。

### Q4: 如何修改日报发送时间？
直接对 Bot 说：“请把 AI 新闻日报的发送时间改为每天 08:30”。Bot 会自动调用 `dingtalk-cron-job` 进行修改。

---

# 场景二：让 AI 半自动运营微博账号

## 一句话价值
把“AI 日报选题 + 配图 + 发布 + 互动”串成一条标准化流程：AI 每天先给你一份待审核运营包，你确认后再执行发布与互动，效率和风险控制兼顾。

## 1. 用到的能力 (Capabilities)
- MCP 工具（四个全用）：
  - `web_search`：抓取微博相关 AI 热点候选
  - `aliyun_web_parser`：解析候选链接正文与上下文
  - `aliyun_code_interpreter`：热点打分、发布时间建议、互动优先级排序
  - `aliyun_wan26_media`：生成配图
- 浏览器能力：
  - `openclaw-browser-quality`：登录态检查、发帖、评论、点赞、回复执行
- 调度能力：
  - `dingtalk-cron-job`：每日定时生成“待审核运营包”

## 2. 账号准备与合规边界 (Account & Compliance)
- 建议使用独立运营账号，不建议直接用个人核心账号做自动化测试。
- 必须遵守微博平台规则；不得用于刷量、批量骚扰、违规营销等行为。
- 风控默认开启：未收到你明确“确认执行”前，AI 只能产出计划，不得执行发布/互动动作。
- 你需要知悉并承担账号风控与封禁风险。
- 服务器资源建议：内存建议 `>= 4GB`；若内存较小，至少配置 `2GB` swap（避免浏览器或技能进程被 OOM 杀死）。
- 网关与浏览器为硬前置：`openclaw gateway status` 必须 `running` 且 `RPC probe: ok`，浏览器必须可成功 `start`。
- 远程环境说明：本流程默认在远程 Linux 上执行，通常没有可视化桌面；登录需要配合快照/截图进行确认，不是本地浏览器点击。

## 3. 单一路径：创建 `weibo-ai-ops` Skill 并上线半自动运营

### 步骤一：创建并初始化 `weibo-ai-ops` skill
在钉钉中 `@AI助手` 发送：

```text
请帮我创建一个可复用 skill，名称为 weibo-ai-ops。
skill 文件路径优先使用：
<workspace>/skills/weibo-ai-ops/SKILL.md
如果你无法确定 <workspace>，就使用：
~/.openclaw/workspace/skills/weibo-ai-ops/SKILL.md

这个 skill 要强绑定 ai-news-daily：
1) 每日选题优先使用 ai-news-daily 当日结果；
2) 如果 ai-news-daily 信息不足，再补充实时热点；
3) 必须使用以下四个 MCP 工具并说明各自职责：
- web_search：抓取热点候选
- aliyun_web_parser：解析正文和上下文
- aliyun_code_interpreter：打分、排序、建议发布时间
- aliyun_wan26_media：生成配图
4) 执行微博页面操作时，必须调用 openclaw-browser-quality。

请把以下风控规则写进 skill 正文并设为硬约束：
1) 默认半自动审核：先输出“待审核运营包”，不自动发布、不自动互动；
2) 只有当用户明确回复“确认执行”时，才允许执行发布/点赞/评论/回复；
3) 每日上限：1 条发布，互动总数 <= 10；
4) 输出前必须自检，字段不完整不发送。

创建完成后，请返回：
- skill 路径
- skill 摘要
- 初始化检查结果（是否可调用 ai-news-daily、skill 依赖关系和配置项是否存在）

初始化检查要求（必须遵守）：
1) 只做结构检查与配置检查；
2) 不要发起 MCP 参数探测调用（避免因为探测参数不匹配导致“假失败”）；
3) 工具可用性放到后续试跑阶段再验证。
```

### 步骤二：登录前健康检查（必须先做）
继续发送：

```text
请先执行“微博登录前健康检查”，不要直接打开微博：
1) 检查 openclaw gateway status，必须是 running 且 RPC probe ok；
2) 检查 openclaw browser status；如果 running=false，先启动 browser；
3) 检查服务器资源（free -h）：
   - 若“可用物理内存 (available)”不足 700MB 且 SwapTotal=0，请告知用户并直接配置 2GB swap 空间（参考命令：sudo fallocate -l 2G /swapfile && sudo chmod 600 /swapfile && sudo mkswap /swapfile && sudo swapon /swapfile，并写入 /etc/fstab 持久化）；
   - 配置完成后再次执行 free -h 确认：必须满足“可用物理内存 + SwapTotal > 2GB”才可继续；
   - 若配置后仍未达标（如物理内存极低），返回“资源不足，暂停登录流程”并给出人工扩容建议；
4) 仅当以上全部通过时，回复“健康检查通过，可以进入登录步骤”。
如果网关或浏览器检查失败，请停止后续动作，不要尝试发帖或互动。
```

### 步骤三：登录微博并持久化登录态（可恢复流程）
继续发送：

```text
请调用 openclaw-browser-quality 执行微博登录并保存登录态，按以下顺序执行：
1) 打开 https://weibo.com/login.php；
2) 切换到二维码登录方式；
3) 每 10 秒发送一次当前登录页截图（包含二维码），二维码失效时自动刷新并继续发送；
4) 等我回复“已扫码”，再继续后续验证（最多等待 5 分钟）；
5) 我回复“已扫码”后，再访问 https://weibo.com 并验证首页可访问；
6) 输出结论：登录态已保存 / 登录态未保存；
7) 若出现 “Can't reach the OpenClaw browser control service (timed out...)”，自动执行一次恢复：
- restart gateway
- start browser
- 重新打开登录页
仅允许重试 1 次；仍失败则停止并返回故障清单。
注意：在登录态验证通过前，不得执行发帖、评论、点赞、回复。
```

扫码说明（给操作者）：
- 你只需要做两件事：看到二维码后用手机微博 App 扫码，并在钉钉回复“已扫码”。
- 未收到“登录态已保存”前，视为登录流程尚未完成。

### 步骤四：手动试跑“今日待审核运营包”（不直接执行）
继续发送：

```text
请调用 weibo-ai-ops，生成“今日待审核运营包”，但不要执行发布和互动。
硬性要求：
1) 选题优先来自 ai-news-daily；不足时再补实时热点；
2) 生成 1 条今日主帖草稿，并配 1 张图片；
3) 生成互动候选清单（最多 10 条），每条给出动作建议与风险等级；
4) 先输出运营包，明确标注“未执行，等待确认”；
5) 只有我回复“确认执行”后，你才可以真正执行发布/互动。
```

### 步骤五：创建每日定时任务（半自动模式）并做首次验收
继续发送：

```text
请调用 dingtalk-cron-job 创建一个每日定时任务：
- 任务名：微博AI运营待审包
- 时间：每天 09:30（Asia/Shanghai）
- 目标：当前钉钉会话
- 执行内容：调用 weibo-ai-ops 生成“待审核运营包”并发送
- 重要：只生成待审包，不自动发布、不自动互动

创建后请立即做首次验收：
1) 强制执行一次任务并等待最终结果；
2) 查看最近运行记录；
3) 返回：是否成功、失败原因（如有）、下次执行时间。
```

## 4. 场景二输出合同（必须固定）
### 4.1 待审核运营包必须包含
1. 今日主帖草稿：标题、正文、话题标签、发布时间建议
2. 配图说明：图片提示词 + 生成结果链接/本地文件说明
3. 互动候选清单（最多 10 条）：目标链接、动作建议、理由、风险等级
4. 待执行动作汇总：明确写“未执行，等待确认”

### 4.2 确认执行后的回执必须包含
1. 已执行动作列表
2. 成功/失败明细
3. 失败重试建议
4. 次日优化建议

## 5. 失败与降级说明 (Fallback Policy)
- `web_search` 不可用：以 `ai-news-daily` 当日结果为主，标注“覆盖下降”。
- `aliyun_web_parser` 不可用：仅基于标题/摘要做低置信计划，并标注“不确定”。
- `aliyun_code_interpreter` 不可用：改用规则化评分（来源权重 + 时效）并说明误差风险。
- `aliyun_wan26_media` 不可用：改为纯文本帖或占位图策略，并说明原因。
- 浏览器控制链路超时（如 20s timeout）：允许自动恢复 1 次（restart gateway + start browser + reopen）；二次失败后停止自动化并返回故障清单。
- 浏览器登录态失效：停止高风险动作（发布/互动），先提示重新登录。
- 系统资源不足（低内存/无 swap）：暂停登录与发布流程，只输出待人工处理清单和扩容建议。
- 任一关键步骤失败：不执行发布/互动，仅返回“待人工处理清单”。

## 6. 验收用例 (Acceptance Tests)
1. Happy Path（全工具可用）
   - 预期：成功生成待审核运营包；确认后可发布 1 条并执行不超过 10 次互动。
2. 工具缺失降级
   - 预期：分别关闭四个工具后仍可产出降级运营包，并明确写出能力下降与风险。
3. 登录态失效
   - 预期：不中断说明流程，但停止执行发布/互动并要求重登。
4. 浏览器超时与恢复
   - 预期：首次超时触发自动恢复；若恢复后仍超时，流程终止并输出故障清单。
5. 二维码登录链路
   - 预期：AI 能持续发送二维码截图；用户回复“已扫码”后能完成登录态验证并明确返回“登录态已保存/未保存”。
6. 风控校验
   - 预期：没有“确认执行”口令时，不得执行任何发布/互动动作；超过上限自动截断。
7. 场景联动
   - 预期：选题优先使用 `ai-news-daily`，且在输出中标注引用来源。

## 7. 默认值与假设
- 平台：微博（仅此平台）
- 自动化模式：半自动审核
- 工具要求：四个 MCP 工具全部启用（含 `aliyun_wan26_media`）
- 联动模式：强绑定 `ai-news-daily`
- 日节奏：每日 1 条主帖 + 最多 10 次互动
- 定时任务时间：每天 `09:30`（`Asia/Shanghai`）
- 文档语言：中文
